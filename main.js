(()=>{var t={108:()=>{var t={formSelector:".popup__edit",inputSelector:".popup__info",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_inactive",inputErrorClass:"popup__edit_type_error",errorClass:"popup__error-massage_active"},e=function(e,n){n.validity.patternMismatch?n.setCustomValidity(n.dataset.errorMessage):n.setCustomValidity(""),n.validity.valid?function(t,e,n){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,n,t):function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,n,n.validationMessage,t)},n=function(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!1,e.classList.remove(n.inactiveButtonClass)):(e.disabled=!0,e.classList.add(n.inactiveButtonClass))};!function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(o){o.addEventListener("submit",(function(t){t.preventDefault()})),function(t,o){var r=Array.from(t.querySelectorAll(o.inputSelector)),c=t.querySelector(o.submitButtonSelector);n(r,c,o),t.addEventListener("reset",(function(){setTimeout((function(){n(r,c,o)}),0)})),r.forEach((function(a){a.addEventListener("input",(function(){e(t,a),n(r,c,o)}))}))}(o,t)}))}(t)}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var c=e[o]={exports:{}};return t[o](c,c.exports,n),c.exports}n.p="",(()=>{"use strict";function t(t){"Escape"===t.key&&o(document.querySelector(".popup_opened"))}function e(e){document.addEventListener("keydown",t),e.classList.add("popup_opened")}function o(e){document.removeEventListener("keydown",t),e.classList.remove("popup_opened")}n.p,n.p,n.p,n.p,n.p,n.p;var r=document.forms.editCards;function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,c=[],a=!0,i=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(c.push(o.value),!e||c.length!==e);a=!0);}catch(t){i=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}r.addEventListener("submit",(function(t){t.preventDefault(),q("add-button-img",!0),fetch("https://nomoreparties.co/v1/plus-cohort-17/cards",{method:"POST",headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"},body:JSON.stringify({name:u.value,link:i.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){P(t.link,t.name,t.likes.length,t._id),r.reset()})).catch((function(t){console.error(t)})).finally((function(){q("add-button-img",!1)})),o(p)}));var i=document.querySelector("#input-src"),u=document.querySelector("#input-text-img"),s=document.querySelector(".profile__avatar"),d=document.querySelector(".profile__name"),l=document.querySelector("#popup-avatar"),p=document.querySelector("#popup-container-place"),f=document.querySelector("#input-name"),m=document.querySelector("#input-about"),h=document.querySelector(".profile__status"),y=document.querySelector("#input-src-avatar"),v=document.querySelector("#popup"),_=document.forms.editAvatar;function S(t){return fetch("https://nomoreparties.co/v1/plus-cohort-17/cards/".concat(t),{method:"DELETE",headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}})}function b(t){return fetch("https://nomoreparties.co/v1/plus-cohort-17/cards/likes/".concat(t),{method:"DELETE",headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}})}function q(t,e){document.querySelector("#".concat(t)).textContent=e?"Сохранение...":"Сохранить"}function k(t,e){document.querySelector("#".concat(t)).textContent=e?"Удаление...":"Да"}function C(t,e,n,o,r){Promise.all([fetch("https://nomoreparties.co/v1/plus-cohort-17/users/me ",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}}),fetch("https://nomoreparties.co/v1/plus-cohort-17/cards",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}})]).then((function(t){return Promise.all(t.map((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})))})).then((function(a){for(var i,u,s=c(a,2),d=s[0],l=s[1],p=l.length-1;p>=0;p--)r===l[p]._id&&l[p].likes.length>=0&&t===l[p].name&&e===l[p].link&&!o.target.classList.contains("card__like_status_on")?(o.target.classList.add("card__like_status_on"),i=l[p]._id,u=d,fetch("https://nomoreparties.co/v1/plus-cohort-17/cards/likes/".concat(i),{method:"PUT",headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"},body:JSON.stringify(u)}),n.textContent=l[p].likes.length+1):r===l[p]._id&&l[p].likes.length>=0&&t===l[p].name&&e===l[p].link&&o.target.classList.contains("card__like_status_on")&&(o.target.classList.remove("card__like_status_on"),b(l[p]._id),n.textContent=l[p].likes.length-1)})).catch((function(t){console.error(t)}))}function g(t){Promise.all([fetch("https://nomoreparties.co/v1/plus-cohort-17/users/me ",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}}),fetch("https://nomoreparties.co/v1/plus-cohort-17/cards",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}})]).then((function(t){return Promise.all(t.map((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})))})).then((function(e){for(var n=c(e,2),o=n[0],r=n[1],a=r.length-1;a>=0;a--)JSON.stringify(r[a].likes[0])===JSON.stringify(o)&&t.querySelector(".card__like").classList.add("card__like_status_on")})).catch((function(t){console.error(t)}))}Promise.all([fetch("https://nomoreparties.co/v1/plus-cohort-17/users/me ",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}}),fetch("https://nomoreparties.co/v1/plus-cohort-17/cards",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}})]).then((function(t){return Promise.all(t.map((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})))})).then((function(t){for(var n,o,r,a,i=c(t,2),u=i[0],l=i[1],p=l.length-1;p>=0;p--)l[p].owner.name===u.name?P(l[p].link,l[p].name,l[p].likes.length,l[p]._id):(n=l[p].link,o=l[p].name,r=l[p].likes.length,a=l[p]._id,E.prepend(function(t,n,o,r){var c=document.querySelector("#card-template").content,a=c.querySelector(".card").cloneNode(!0),i=a.querySelector(".card__img");return i.setAttribute("src",t),a.querySelector(".card__name").textContent=n,a.querySelector(".card__like-counter").textContent=o,i.setAttribute("alt",n),a.querySelector(".card__like").addEventListener("mousedown",(function(e){c.querySelector(".card").id=r,C(n,t,a.querySelector(".card__like-counter"),e,c.querySelector(".card").id)})),a.querySelector(".card__like-counter").textContent>0&&g(a),i.addEventListener("click",(function(o){o.preventDefault(),e(L),j.textContent=n,A.setAttribute("src",t),A.setAttribute("alt",n)})),a.querySelector(".card__trash").remove(),a}(n,o,r,a)));d.textContent=u.name,h.textContent=u.about,s.setAttribute("src",u.avatar)})).catch((function(t){console.error(t)}));var L=document.querySelector(".popup_img"),E=document.querySelector(".cards-grid"),j=document.querySelector(".popup_img_name"),A=document.querySelector(".popup_img_photo"),x=document.querySelector("#popup-confirm"),T=document.forms.confirmDelete;function P(t,n,r,c){E.prepend(function(t,n,r,c){var a=document.querySelector("#card-template").content,i=a.querySelector(".card").cloneNode(!0),u=i.querySelector(".card__img"),s=i.querySelector(".card__trash");return u.setAttribute("src",t),i.querySelector(".card__name").textContent=n,i.querySelector(".card__like-counter").textContent=r,u.setAttribute("alt",n),i.querySelector(".card__like").addEventListener("mousedown",(function(e){a.querySelector(".card").id=c,C(n,t,i.querySelector(".card__like-counter"),e,a.querySelector(".card").id)})),i.querySelector(".card__like-counter").textContent>0&&g(i),s.addEventListener("click",(function(){e(x),a.querySelector(".card").id=c,T.addEventListener("submit",(function(){!function(t,e,n,o){k("confirm-delete-button",!0),fetch("https://nomoreparties.co/v1/plus-cohort-17/cards",{headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(r){for(var c=r.length-1;c>=0;c--)t===r[c].name&&e===r[c].link&&o===r[c]._id&&(S(r[c]._id),n.remove())})).catch((function(t){console.error(t)})).finally((function(){k("confirm-delete-button",!1)}))}(n,t,i,a.querySelector(".card").id),o(x)}))})),u.addEventListener("click",(function(o){o.preventDefault(),e(L),j.textContent=n,A.setAttribute("src",t),A.setAttribute("alt",n)})),i}(t,n,r,c))}n(108);var z=document.forms.editProfile,w=document.querySelector(".profile__add-button"),D=document.querySelector(".profile__edit"),O=document.querySelector(".profile__avatar_edit");document.querySelectorAll(".popup").forEach((function(t){t.addEventListener("mousedown",(function(e){e.target.classList.contains("popup_opened")&&o(t),e.target.classList.contains("popup__close-icon")&&o(t)}))})),D.addEventListener("click",(function(){e(v),f.setAttribute("value",d.textContent),m.setAttribute("value",h.textContent)})),O.addEventListener("click",(function(){return e(l)})),s.addEventListener("click",(function(){return e(l)})),w.addEventListener("click",(function(){return e(p)})),_.addEventListener("submit",(function(t){t.preventDefault(),q("add-button-img-avatar",!0),fetch("https://nomoreparties.co/v1/plus-cohort-17/users/me/avatar ",{method:"PATCH",headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"},body:JSON.stringify({avatar:y.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(e){t.preventDefault(),s.setAttribute("src",e.avatar),_.reset()})).catch((function(t){console.error(t)})).finally((function(){q("add-button-img-avatar",!1)})),o(l)})),z.addEventListener("submit",(function(t){t.preventDefault(),q("add-button-inf",!0),fetch("https://nomoreparties.co/v1/plus-cohort-17/users/me ",{method:"PATCH",headers:{authorization:"c8ce4a71-bdd1-470d-8928-726e47ccdf35","Content-Type":"application/json"},body:JSON.stringify({name:f.value,about:m.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){d.textContent=t.name,h.textContent=t.about,s.setAttribute("src",t.avatar)})).catch((function(t){console.error(t)})).finally((function(){q("add-button-inf",!1)})),o(v)}))})()})();